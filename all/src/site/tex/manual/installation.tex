% !TEX root = manual.tex
\chapter{Installation \& Configuration} \label{ch:install}

\section{Requirements}

We have tested the system on Mac OS X and Linux. It is designed to run on Unix platforms. Windows is not supported although it may run with a Unix-like shell under Windows.

Further requirements for running LTC are as follows.
\begin{description}
\item[Java] 1.6 or above.  If using the \Code{jar} tool to extract Emacs Lisp files, you will need the JDK, otherwise the JRE should suffice.
\item[Version Control System]  One of the version control systems below:
  \begin{description}
  \item[git] 1.7.2 or above.
  \item[svn] 1.6.3 or above.
  \end{description}
\item[Emacs] 23 or above.  Only if the user wants to use \Code{ltc-mode} in Emacs to interact with LTC.  XEmacs is not supported.
\end{description}

\section{Installation and Update}

Currently, we provide a shell script \Code{ltc-install.sh} to perform LTC installation and updates.  It can be downloaded from \url{http://sourceforge.net/projects/latextrack/files/}.  Use it to install the LTC JAR file in a location of your choice.  Also, if you use the Emacs \Code{ltc-mode}, be prepared to supply the location where to put the Emacs Lisp files (see more details below in Section~\ref{sec:config-emacs}).

In the future, we may provide installers for the target platforms.

Let us assume for the remainder of this manual, that you have used a directory called \Code{\$LTC} as the installation location. Then, you would install LTC using the script in the following way.  Note that you will need a second argument to install LTC for Emacs as explained in more detail below (Section~\ref{sec:config-emacs}).  It doesn't hurt to run the script twice, as it will replace LTC with the latest version.

\begin{CodeVerbatim}
$> bash ltc-install.sh -h
[... prints help message about using LTC install script]
$> bash ltc-install.sh $LTC
[...]
Done with installing LTC in $LTC
To start LTC server with default options, use the following command:

  java -jar $LTC/LTC.jar

\end{CodeVerbatim}

To update from an earlier LTC version, run the \Code{ltc-install.sh} script again with the same argument(s).  The script will download the latest version from the web site and configure the link in \Code{\$LTC/LTC.jar} so that future invocations  will resolve to the newest version.

After installing LTC, you can look at the command line options of LTC Server using the switch \Code{-h} or omit the switch to start LTC Server with default values.
\begin{CodeVerbatim}
$> java -jar $LTC/LTC.jar -h
[... prints help message about using LTC Server]
\end{CodeVerbatim}

\section{Configuration}

This section contains details of configuring git or svn, LTC and Emacs to work together.  These steps typically only need to be carried out once per installation of LTC.

Note that the system decides automatically whether your LaTeX file is under git or svn version control.

\subsection{General Git Configuration}

The current version of LTC supports git as an underlying version control system, which manages the history of the LaTeX files of interest. If you are already using git for other things, you may skip the following few steps as your git is probably already configured. However, we do recommend to add the common LaTeX build products with wildcards to the list of ignored files as outlined at the end of this section, which may not be configured if git has not been used to manage repositories with LaTeX files.

First, test that the git installation is found. Otherwise, you may want to add the git binary directory to the \Code{PATH} environment variable.  
\begin{CodeVerbatim}
$> git --version
git version 1.7.2
\end{CodeVerbatim}

If you haven't done already, configure git with your name and email address:
\begin{CodeVerbatim}
$> git config --global user.name "John Doe"
$> git config --global user.email doe@inter.net
\end{CodeVerbatim}

Typically, you don't want to track automatic backups and build products of your LaTeX project, so create a file \Code{\char`\~/.gitignore\_global} (or any name and location of your choice) and add the following lines as contents. 
\begin{CodeVerbatim}
*~
*.out
*.aux
*.bbl
*.blg
*.bst
*.dvi
*.idx
*.lof
*.log
*.toc
*.lol
*.lot
\end{CodeVerbatim}
Then, issue the git config command below (with a possibly adjusted file name and location).

\begin{CodeVerbatim}
$> git config --global core.excludesfile ~/.gitignore_global
\end{CodeVerbatim}

To learn how to set up a writing project under a git repository for using it with LTC refer to Section~\ref{sec:git-use}.

\subsection{General Subversion Configuration}

First, test that the svn installation is found. Otherwise, you may want to add the svn binary directory to the \Code{PATH} environment variable.  
\begin{CodeVerbatim}
$> svn --version
svn, version 1.6.18 (r1303927)
   compiled Aug  4 2012, 19:46:53

...
\end{CodeVerbatim}

[TODO: write more about subversion configuration here!]

%\subsection{LTC Server}

\subsection{Emacs \texttt{ltc-mode}} \label{sec:config-emacs}

To use the supplied \Code{ltc-mode} in Emacs, you will have to put the relevant mode files into a directory where Emacs can load them. There are two alternatives of letting Emacs know where to find Emacs Lisp files:
\begin{enumerate}
\item Use a location that is already included in the \Code{load-path}. To view the contents of this path in your Emacs, execute the command \Code{C-h v load-path}.  On Mac OS X systems with Aquamacs, this could be for example \Code{\char`\~/Library/Preferences/Emacs}.
\item Add a new directory where you will extract the Emacs Lisp files to the \Code{load-path}. Assuming the Emacs Lisp files will be installed in directory \Code{\char`\~/.emacs.d/}, add the following line to your \Code{.emacs} or other Emacs configuration file:
  \begin{CodeVerbatim}
(add-to-list 'load-path "~/.emacs.d")
  \end{CodeVerbatim}
\end{enumerate}

Now based on which method of the above you choose, supply the directory \Code{\$EMACS\_DIR} as the second argument to the install script:
\begin{CodeVerbatim}
$> bash ltc-install.sh $LTC $EMACS_DIR
\end{CodeVerbatim}

In order to enable the LTC mode in Emacs, add the following line to your \Code{.emacs} or other Emacs configuration file (for example, \Code{\char`\~/Library/Preferences/Emacs/Preferences.el} is the default for Aquamacs under Mac OS X) :
\begin{CodeVerbatim}
(autoload 'ltc-mode "ltc-mode" "" t)
\end{CodeVerbatim}

We recommend to avoid adding a hook from \Code{latex-mode} to \Code{ltc-mode} (usually done with \Code{add-hook}) as our mode requires the \Code{latex-mode} to be fully executed before it works. The hooks are not guaranteed to be executed in particular order, so it is best to manually invoke LTC mode after you have opened a \Code{.tex} file.

\begin{figure}[t]
\centering
\mygraphics{width=\textwidth,height=.5\textheight,keepaspectratio}{figures/emacs-port}
\caption{Customizing LTC port number in Emacs} \label{fig:emacs-port}
\end{figure}

If you need to change the port number that Emacs uses to communicate with the LTC Server (for example, if the default number is already in use on your computer), you first have to load \Code{ltc-mode} at least once (possibly with a failure) using command \Code{M-x ltc-mode}.  Then, you can view the current port setting using \Code{C-h v ltc-port <RET>}.  You can customize the port number using \Code{M-x customize-group <RET> ltc <RET>} or open the customization buffer and browse to the LTC group under the Tex group, which may be located under the Wp (word processing) top-level group.  See Figure~\ref{fig:emacs-port} for a screenshot when customizing the port number using the customization buffer in Aquamacs under Mac OS X.

%\subsubsection{Git from Emacs}
%
%The user can interact with git from within Emacs.  One of the many implementations is called ``magit'' mode.

\section{Troubleshooting}

We are keeping a list of \hlink{\baseurl /faq.html}{../../faq.html}{frequently-asked-questions} at the project's web site that may help for troubleshooting.  There will also be mailing lists and a way to report bugs available in the future.
